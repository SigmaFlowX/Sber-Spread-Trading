# About the strategy
The strategy can be used for any cointegrated assets, but I used SBER and SBERP shares on MOEX. 


A simple linear model is used:
Price(asset1) = a * Price(asset2) + b + E, <br>
where E is stationary and mean revearting.

Then the rolling Z-score is calculated for E = a * Price(asset1) - Price(asset2) - b <br>

Entry conditions: <br>
If z > z_threshold: short a * SBER and long SBERP <br>
If z < -z_threshold: short SBERP and long a * SBERP

Exit conditions: <br>
z <= 0 <br>
z >= 0 <br>

Walk forward optimization is performed using optuna. <br>
Fees and included in the model, but not the slippage.

# Walk-Forward Optimization Results
Initial balance for each following tests is 100 000 and 10% of the balance is used for trades. 
## 10 mintues timeframe, 0.008% fee
Annialized return is 5.9% 

Sharpe ratio is 0.7
| train_start   | train_end   | test_start   | test_end   |   annualized_return_% |   profit_% |   absolute_profit |   total_trades |   win_ratio_% |   avg_holding_hours |   max_pnl |   min_pnl |   avg_pnl |   paid_fees |   z_threshold |   spread_window |   z_window |
|:--------------|:------------|:-------------|:-----------|----------------------:|-----------:|------------------:|---------------:|--------------:|--------------------:|----------:|----------:|----------:|------------:|--------------:|----------------:|-----------:|
| 2020-01-03    | 2020-07-03  | 2020-07-03   | 2020-10-03 |                   5.6 |        1.2 |              1194 |            729 |          76.1 |                 1.8 |      61.5 |    -102.4 |       3.2 |      1148.6 |      0.784295 |             638 |          9 |
| 2020-04-03    | 2020-10-03  | 2020-10-03   | 2021-01-03 |                   4.6 |        1   |              1062 |            239 |          70.7 |                 7.4 |      79.9 |     -96.9 |       6   |       380.4 |      0.680146 |             102 |         61 |
| 2020-07-03    | 2021-01-03  | 2021-01-03   | 2021-04-03 |                   7.8 |        1.8 |              1875 |            946 |          67.5 |                 1   |    1416.4 |     -44.8 |       3.6 |      1531.6 |      1.09893  |              10 |          5 |
| 2020-10-03    | 2021-04-03  | 2021-04-03   | 2021-07-03 |                   2.8 |        0.7 |               686 |            376 |          73.7 |                 4.3 |     111.4 |     -48.2 |       3.4 |       611.2 |      0.472342 |              53 |        112 |
| 2021-01-03    | 2021-07-03  | 2021-07-03   | 2021-10-03 |                   3.9 |        0.9 |               939 |            368 |          79.9 |                 4.2 |      25.3 |     -30.9 |       4.2 |       602.4 |      1.0709   |             282 |         26 |
| 2021-04-03    | 2021-10-03  | 2021-10-03   | 2022-01-03 |                   6.3 |        1.5 |              1541 |            279 |          76.7 |                 4.9 |     163.3 |     -84.5 |       7.2 |       461.2 |      1.15475  |             310 |         37 |
| 2021-07-03    | 2022-01-03  | 2022-01-03   | 2022-04-03 |                  12.4 |        2.8 |              2999 |            201 |          74.6 |                 1.6 |     872.1 |    -171.2 |      16.6 |       339.1 |      1.46118  |              15 |        143 |
| 2021-10-03    | 2022-04-03  | 2022-04-03   | 2022-07-03 |                  25.3 |        5.5 |              6094 |            485 |          80.4 |                 3.4 |     201.6 |    -167   |      14.4 |       874.8 |      0.411996 |              40 |         20 |
| 2022-01-03    | 2022-07-03  | 2022-07-03   | 2022-10-03 |                  14   |        3.2 |              3741 |            605 |          81.8 |                 2.6 |     188.5 |     -83.7 |       8.1 |      1130.5 |      0.776474 |             149 |         11 |
| 2022-04-03    | 2022-10-03  | 2022-10-03   | 2023-01-03 |                  11.1 |        2.6 |              3129 |            692 |          82.4 |                 1.9 |     128.7 |     -62.2 |       6.5 |      1339.5 |      0.780238 |             166 |         13 |
| 2022-07-03    | 2023-01-03  | 2023-01-03   | 2023-04-03 |                   4.5 |        1.1 |              1341 |            746 |          77.2 |                 1.6 |      89.9 |    -256.6 |       3.8 |      1456.8 |      0.72375  |              10 |         71 |
| 2022-10-03    | 2023-04-03  | 2023-04-03   | 2023-07-03 |                   3.7 |        0.9 |              1118 |            726 |          77.3 |                 1.9 |     128   |     -70.4 |       3.5 |      1427.6 |      0.746702 |              17 |         20 |
| 2023-01-03    | 2023-07-03  | 2023-07-03   | 2023-10-03 |                  -1.5 |       -0.4 |              -471 |           1403 |          72.2 |                 1   |     117.7 |    -166.6 |       1.6 |      2755.3 |      0.409599 |              10 |          6 |
| 2023-04-03    | 2023-10-03  | 2023-10-03   | 2024-01-03 |                   5.8 |        1.2 |              1462 |            337 |          97.9 |                 3.5 |      23.8 |     -10.4 |       6.3 |       664.5 |      1.11241  |             992 |         53 |
| 2023-07-03    | 2024-01-03  | 2024-01-03   | 2024-04-03 |                   2.9 |        0.6 |               734 |            431 |          94.4 |                 3.4 |      50.2 |     -14.3 |       3.7 |       857.7 |      0.59174  |             962 |         41 |
| 2023-10-03    | 2024-04-03  | 2024-04-03   | 2024-07-03 |                   2.2 |        0.5 |               644 |            356 |          89.6 |                 4.5 |      25.3 |     -11.5 |       3.8 |       709.6 |      0.806328 |             243 |         57 |
| 2024-01-03    | 2024-07-03  | 2024-07-03   | 2024-10-03 |                   3.9 |        0.9 |              1128 |            269 |          93.3 |                 5.8 |      30.8 |      -8.9 |       6.2 |       541.7 |      0.613882 |             335 |        243 |
| 2024-04-03    | 2024-10-03  | 2024-10-03   | 2025-01-03 |                   4.5 |        1   |              1296 |            327 |          96.9 |                 4   |      49.2 |     -32.3 |       6   |       666.2 |      0.689393 |             357 |        184 |
| 2024-07-03    | 2025-01-03  | 2025-01-03   | 2025-04-03 |                   5.2 |        1.1 |              1498 |            667 |          85.5 |                 2   |      52.9 |     -17.3 |       4.3 |      1367   |      1.01727  |             275 |         16 |
| 2024-10-03    | 2025-04-03  | 2025-04-03   | 2025-07-03 |                   6.6 |        1.6 |              2083 |            647 |          90.1 |                 2.5 |      45.8 |     -25.6 |       5.3 |      1345.4 |      0.784313 |              85 |         53 |
| 2025-01-03    | 2025-07-03  | 2025-07-03   | 2025-10-03 |                   2.8 |        0.6 |               857 |            499 |          86.8 |                 2.9 |      30   |    
-148.4 |       3.8 |      1049.2 |      0.714931 |              66 |        696 |


![Equity Curve](images/10m0.008.png)


## Data links

SBER<br>https://drive.google.com/file/d/1HjTwX0ZIwoqtYKKdl5y3fG3rUgcYqZiT/view?usp=sharing

SBERP<br>https://drive.google.com/file/d/1h9tjGM8Yg-Q_uYlmIJrtxOePQApaBU4L/view?usp=sharing






